<?php
class KpiDashboardController
{

    /**
     * @route("GET /kpi/dashboard")
     */
    function kpi_dashboad($f3)
    {
        echo \template::instance()->render("kpi-dashboard/kpi_dashboard.html");
    }

    /**
     * @route("GET /admin/kpi/dashboard")
     */
    function kpi_dashboad_admin($f3)
{
    $f3->set('filters', VuePlanningModel::get_filters(['reference', 'type']));
    
    // Produits non filtrÃ©s (vue initiale)
    $mapper = new DB\Cortex(base::instance()->DB, "vue_prod_planning");
    $produits = $mapper->find(null, ['order' => 'id DESC']);
    $f3->set('produits', $produits);

    // Pour ne pas avoir d'erreurs dans le template
    $f3->set('selected_types', []);
    $f3->set('selected_refs', []);

    echo \Template::instance()->render("kpi-dashboard/kpi_dashboard_admin.html");
}

}
